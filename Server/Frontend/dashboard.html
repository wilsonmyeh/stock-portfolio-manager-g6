<!doctype html>

<html>

	<head>

		<title>Your Dashboard</title>
		<link rel="icon" href="images/favicon.png">
		<link rel="stylesheet" href="style.css">

		<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>

		<script>

			function startTime() {
				var today = convertToEasternStandardTimeZone(new Date());
				var date = today.toDateString();
				var hour = (today.getHours()+11)%12 + 1;
				var min = today.getMinutes();
				var sec = today.getSeconds();
				hour = checkTime(hour);
				min = checkTime(min);
				sec = checkTime(sec);
				document.getElementById('clock').innerHTML = date + ",\n" + hour + ":" + min + ":" + sec + " EST";
				if((hour = 9 && min < 30) || (hour < 9) || (hour > 16)){
					disableBuySell(true);
				}
				var t = setTimeout(startTime, 500);
			}
			function checkTime(i) {
				if (i < 10) {
					i = "0" + i;
				}
				return i;
			}
			function disableBuySell(allow) {
				document.getElementById("buybutton").disabled = allow;
				document.getElementById("sellbutton").disabled = allow;
			}
			function convertToEasternStandardTimeZone(date) {
				//EST
				offset = -5.0;
				clientDate = date;
				utc = clientDate.getTime() + (clientDate.getTimezoneOffset() * 60000);
				ESTDate = new Date(utc + (3600000*offset));
				return ESTDate;
			}

			function populatePortfolio() {
				var xhttp = new XMLHttpRequest();
				xhttp.onreadystatechange = function() {
						if (xhttp.readyState == 4 && xhttp.status == 200) {
						document.getElementById("portfoliocontent").innerHTML = xhttp.responseText;
					}
				};
				xhttp.open("GET", "http://localhost/Frontend/retrievePortfolioYahoo.php", true);
				xhttp.send();
				$(function(){
					$("#portfolio").css('overflow-y', 'top');
				});
			}

			function populateWatchlist() {
				var xhttp1 = new XMLHttpRequest();
				xhttp1.onreadystatechange = function() {
						if (xhttp1.readyState == 4 && xhttp1.status == 200) {
						document.getElementById("watchlistcontent").innerHTML = xhttp1.responseText;
					}
				};
				xhttp1.open("GET", "http://localhost/Frontend/retrieveWatchlistYahoo.php", true);
				xhttp1.send();
				$(function(){
					$("#watchlist").css('overflow-y', 'top');
				});
			}

			function onLoad() {
				startTime();
				populatePortfolio();
				populateWatchlist();
			}

		</script>

	</head>

	<body onload="onLoad()">

		<h1>Your Dashboard</h1>

		<div id = "dashboard">

			<div class="widget" id="import">
				<h2>Import Portfolio</h2>
				<form action="http://localhost/Frontend/importcsv.php" method="post" enctype="multipart/form-data">
					<input type="file" name="fileToUpload" id="fileToUpload">
					<input type="submit" value="Upload CSV" name="submit">
				</form>
			</div>

			<div class="widget" id="search">
				<h2>Search</h2><br>
				<form action="searchbar.php" method="POST">
					<input type="text" placeholder = "Company Name or Ticker" size = "40">
					<input type="submit" value="Graph" name="graph">
					<input type="submit" value="Add to Watchlist" name="watch">
				</form>
			</div>

			<div class="widget" id="account">
				<h2>Your Account</h2>
				<div id="clock">Sun Feb 21 2016<br>05:49:08</div>
				Account Balance: CA$H<br>
				Portfolio Value: MONEY<br>
				<button type="button">Logout</button>
			</div>

			<div class="widget" id="portfolio">
				<h2>Portfolio Scroll List</h2>
				<div id="portfoliocontent">
					<br><br><br><img src="images/ajax-loader.gif" alt="loading..." style="width:32px;height:32px;">
				</div>
			</div>
			
			<div class="widget" id="graph">
				<h2>Main Line Graph</h2>
			</div>

			<div class="widget" id="manualandlegend">
				<h2>User Manual</h2>
				<a class="button" href="manual.html">User Manual</a>
				<h2>Legend</h2>
			</div>

			<div class="widget" id="buysell">
				<h2>Stock Trader</h2><br>
				<form action="">
				<input type="text" placeholder="Ticker" size = "2">
				<input type="text" placeholder="Company Name" size = "6"><br><br>
				<input type="text" placeholder="Quantity" size = "10"><br><br>
				<input type="submit" value="Buy" id = "buybutton">
				<input type="submit" value="Sell" id = "sellbutton">
				</form>
			</div>

			<div class="widget" id="detailedinfo">
				<h2>Stock Information</h2>

			</div>

			<div class="widget" id="news">
				<h2>News</h2>
				
			</div>

			<div class="widget" id="watchlist">
				<h2>Watchlist</h2>
				<div id="watchlistcontent">
					<br><br><br><img src="images/ajax-loader.gif" alt="loading..." style="width:32px;height:32px;">
				</div>
			</div>

		</div>

	</body>

	<footer>
		<a href="https://youtu.be/dQw4w9WgXcQ">About Us </a>
		<a href="https://youtu.be/dQw4w9WgXcQ">Contact </a>
		<a href="https://youtu.be/dQw4w9WgXcQ">FAQ </a>
		<a href="https://youtu.be/dQw4w9WgXcQ">Terms Of Use </a>
		<a href="https://youtu.be/dQw4w9WgXcQ">Privacy Policy </a>
		<p>COPYRIGHT &#169 2016 CSCI310 2016129967 Project 1 Group 6 All Rights Reserved</p>
	</footer>

</html>	